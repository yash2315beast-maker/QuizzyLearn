<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Rewards - QuizzyLearn</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            font-family: 'Poppins', sans-serif;
            min-height: 100vh;
            background: linear-gradient(-45deg, #6a11cb, #2575fc, #1dd1a1, #feca57);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: white;
            text-align: center;
            padding: 80px 20px;
        }
        @keyframes gradientBG {
            0% {background-position:0% 50%;}
            50% {background-position:100% 50%;}
            100% {background-position:0% 50%;}
        }
        h1 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            font-size: 1rem;
            background: rgba(255,255,255,0.7);
            color: #000;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 10;
        }
        
        #badge-collection-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .badge-card {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        .badge-card.unlocked {
             background: rgba(255, 255, 255, 0.3);
        }
        .badge-card.locked {
            filter: grayscale(100%);
            opacity: 0.6;
        }
        .badge-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .badge-icon { font-size: 4rem; line-height: 1; }
        .badge-name { font-size: 1.2rem; font-weight: 700; margin-top: 10px; }
        .badge-description { font-size: 0.9rem; margin: 5px 0; min-height: 55px; }
        .badge-game { font-size: 0.8rem; font-weight: 600; color: rgba(255,255,255,0.7); margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.2); }
    </style>
</head>
<body>

    <button class="back-btn" onclick="window.location.href='subjects.html'">⬅ Back</button>

    <h1 id="page-title">Your Rewards & Badges</h1>

    <div id="badge-collection-container">
        <!-- Badges from all games will be dynamically inserted here -->
    </div>
    
    <script>
        // This is the master list of ALL possible badges from ALL your games.
        const ALL_BADGES = {
            'math_quiz': {
                gameName: 'Mathematics Quiz',
                badges: {
                    'math_apprentice': { name: 'Math Apprentice', icon: '🧮', description: 'Score 5 or more points.' },
                    'math_whiz': { name: 'Math Whiz', icon: '✨', description: 'Score 8 or more points.' },
                    'calculation_king': { name: 'Calculation King', icon: '👑', description: 'Achieve a perfect score!' }
                }
            },
            'cs_quiz': {
                gameName: 'Computer Science Quiz',
                badges: {
                    'binary_whiz': { name: 'Binary Whiz', icon: '💻', description: 'Score 10 or more points.' },
                    'algorithm_ace': { name: 'Algorithm Ace', icon: '🧠', description: 'Score 13 or more points.' },
                    'code_commander': { name: 'Code Commander', icon: '🚀', description: 'Achieve a top score!' }
                }
            },
            'rocket_race': {
                gameName: 'Rocket Race',
                badges: {
                    'win_light': { name: "Velocity Voyager", icon: "⚡️", description: "Win the race with the Light Rocket." },
                    'win_heavy': { name: "Momentum Master", icon: "🪨", description: "Win the race with the Heavy Rocket." },
                    'flawless_victory': { name: "Physics Phenom", icon: "🏆", description: "Win the race without a single wrong answer." }
                }
            },
            'cannon_commander': {
                gameName: 'Cannon Commander',
                badges: {
                    'commander': { name: "Master Commander", icon: "🏆", description: "Complete all levels." },
                    'sharpshooter': { name: "Sharpshooter", icon: "🎯", description: "Hit a target on the first try." },
                    'physics_whiz': { name: "Physics Whiz", icon: "🧠", description: "Answer every quiz question correctly." }
                }
            },
            'grammar_guardian': {
                gameName: 'Grammar Guardian',
                badges: {
                    'castle_defender': { name: 'Castle Defender', icon: '🏰', description: 'Win the game by defeating all goblin waves.' },
                    'flawless_guardian': { name: 'Flawless Guardian', icon: '🛡️', description: 'Win the game without any damage.' },
                    'grammar_master': { name: 'Grammar Master', icon: '🏆', description: 'Win the game without incorrect answers.' }
                }
            },
            // --- MODIFIED: Added Bio-Luminescence Badges ---
            'bio_luminescence': {
                gameName: 'Bio-Luminescence',
                badges: {
                    'participant': { name: "Lab Assistant", icon: "🔬", description: "Complete the food chain puzzle." },
                    'first_steps': { name: "Field Researcher", icon: "🥉", description: "Correctly assemble at least one food chain." },
                    'high_score': { name: "Skilled Biologist", icon: "🥈", description: "Score 3 or more correct chains." },
                    'perfect_score': { name: "Master Ecologist", icon: "🏆", description: "Correctly assemble all food chains." }
                }
            },
            'cell_explorer': {
                gameName: 'Cell Explorer',
                badges: {
                    'animal_expert': { name: 'Animal Cell Expert', icon: '🐾', description: 'Identify all animal cell organelles.' },
                    'plant_pro': { name: 'Plant Cell Pro', icon: '🌿', description: 'Identify all plant cell organelles.' },
                    'master_biologist': { name: 'Master Biologist', icon: '🔬', description: 'Master both animal and plant cells.' }
                }
            }
        };

        // A complete list of all localStorage keys used by your games.
        const STORAGE_KEYS = [
            'mathQuizBadges',
            'csQuizBadges',
            'rocketRaceEarnedBadges',
            'cannonCommanderBadges',
            'grammarGuardianBadges',
            'cellExplorerEarnedBadges',
            'foodChainEarnedBadges' // MODIFIED: Added the new key
        ];

        function getAllEarnedBadges() {
            const earnedSet = new Set();
            STORAGE_KEYS.forEach(key => {
                const stored = localStorage.getItem(key);
                if (stored) {
                    try {
                        const parsedBadges = JSON.parse(stored);
                        if (Array.isArray(parsedBadges)) {
                            parsedBadges.forEach(badgeId => earnedSet.add(badgeId));
                        }
                    } catch (e) {
                        console.error(`Could not parse badges from key: ${key}`, e);
                    }
                }
            });
            return earnedSet;
        }

        function displayBadges() {
            const earnedBadges = getAllEarnedBadges();
            const container = document.getElementById('badge-collection-container');
            container.innerHTML = '';

            for (const gameId in ALL_BADGES) {
                const game = ALL_BADGES[gameId];
                for (const badgeId in game.badges) {
                    const badge = game.badges[badgeId];
                    const isUnlocked = earnedBadges.has(badgeId);

                    const badgeCard = document.createElement('div');
                    badgeCard.className = `badge-card ${isUnlocked ? 'unlocked' : 'locked'}`;
                    
                    badgeCard.innerHTML = `
                        <div class="badge-icon">${badge.icon}</div>
                        <div class="badge-name">${badge.name}</div>
                        <div class="badge-description">${badge.description}</div>
                        <div class="badge-game">From: ${game.gameName}</div>
                    `;
                    
                    container.appendChild(badgeCard);
                }
            }
        }

        // Run the function when the page loads
        displayBadges();
    </script>

</body>
</html>